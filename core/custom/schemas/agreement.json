{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "http://tmi-platform.org/schemas/agreement.json",

  "definitions": {
    "uei": {"$ref": "http://minimi.org/schemas/fields.json#/definitions/uei"},
    "reference": {"$ref": "http://tmi-platform.org/schemas/fields.json#/definitions/reference"},

    "party": {
      "allOf": [
        {"$ref": "#/definitions/reference"},
        {"enum": ["collective", "user"]}
      ]
    },

    "schemaReference": {
      "allOf": [
        {
          "$ref": "#/definitions/reference",
          "errorMessage": "Invalid reference type."
        },
        {
          "enum": ["schema"],
          "errorMessage": "Inappropriate reference type. Must be 'schema'."
        }
      ]
    }
  },

  "type": "object",
  "title": "Agreement",

  "properties": {
    "id": {"$ref": "#/definitions/uei"},
    "promisor": {"$ref": "#/definitions/party"},
    "promisee": {"$ref": "#/definitions/party"},
    "terms": {"$ref": "#/definitions/schemaReference"}
  }
}